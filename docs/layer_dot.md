---
hide:
  - toc
---

ドット絵レイヤーを選択している時は、「色」ウィンドウで、カラーインデックスが表示されます。

__カラーインデックス__ とは 0 ~ 255 までの数字で、ドット絵レイヤーはこのカラーインデックスをもとに描画されます。

ドット絵レイヤーでは、 RGBA の色で描画するわけではありません。このカラーインデックスで描画します。
カラーインデックスで描画して、そのカラーインデックスに対応する RGB で表示されます。

それぞれのカラーインデックスには、 RGB をそれぞれセットすることができます。
RGBA の A は 255 で固定です。

ただし、このペイントソフトでは、ドット絵レイヤーとそれ以外のレイヤーを共存したいので、
カラーインデックスの 0 番目を透明色で固定にしています。

「色」ウィンドウの上部にある長方形のカラーブロックの中のいずれかを選択すると、
その下のほうに R 数字 G 数字 B 数字 Index 数字 と表示されます。
この Index の部分がカラーインデックスです。

「色」ウィンドウでは、 1 ~ 255 までのカラーインデックスの RGB を調節することができます。
「ドット消しゴム」ツールでは、カラーインデックスの 0 番目(透明色)で塗ることになります。
それ以外のドット絵レイヤー用のツールでは 1 ~ 255 までのいずれかのカラーインデックスで塗ることになります。

「色」ウィンドウの 0 ~ 255 までのカラーインデックスをまとめて、このペイントソフトでは「__パレット__」と呼びます。

パレットには共通パレットとレイヤーパレットがあります。
共通パレットは、キャンバスごとに 1 つで、キャンバス内のすべてのドット絵レイヤーで共通で使うことができます。
レイヤーパレットは、ドット絵レイヤーごとに別々のパレットです。

「色」ウィンドウの中の「__レイヤーパレットまたは共通パレット__」のチェックボックスで、
選択しているドット絵レイヤーが、共通パレットを使うか、レイヤーパレットを使うかを選択することができます。

「色」ウィンドウの中の「__共通パレットからレイヤーへ__」ボタンをクリックすると、
共通パレットの内容がレイヤーパレットにコピーされます。
「__レイヤーパレットから共通へ__」ボタンはその逆です。

本来であれば、「色」ウィンドウのカラーインデックスの RGB を変更した場合は、
自動的にドット絵レイヤーの描画内容の見た目が、その変更した色に変わるべきですが、
現状では、このペイントソフトでは自動的に変更されません。

パレットの内容を変更した場合は、「色」ウィンドウの中にある「__変更したパレットでキャンバス更新__」ボタンを
クリックすることで、キャンバス内のすべてのドット絵レイヤーの描画内容の見た目が更新されます。


## パレットの保存と読み込み

「色」ウィンドウの「__読込__」と「__保存__」ボタンで、
パレットを、 pal 形式で保存し、読み込むことができます。

pal 形式は、テキストファイルなのでテキストエディタで編集することができます。

```
JASC-PAL
0100
256
0 0 0
255 216 198
225 160 148
これより下は省略
```

4行目からカラーインデックス順に RGB の3つの数字が並びます。

パレットの読み込みに関しては、このテキストファイルの pal 形式のほかに、
「高機能ドット絵エディタ EDGE」の中で使われている EDGE 専用 pal 形式も読み込むことができます。


## gif 形式のファイルの保存と読み込み

メニューの「レイヤー」をクリックし、「ドット絵レイヤー」から「__キャンバスの読み込み (gif)__」
をクリックすることで、 gif 形式のファイルを読み込み、キャンバスを作成することができます。

読み込む gif に複数のフレームがあるなら、キャンバス内にすべてのフレームが表示されるようにして
キャンバスが作成されます。
gif の幅と高さが、そのままキャンバスの幅と高さにならないということです。

例えば、 13 フレームの gif なら、キャンバスの左上が 1 フレーム目で、その右隣が 2 フレーム目になり、
キャンバスの幅に対して 4 フレームまで入った後、 5 フレーム目はその1つ下の段になります。
キャンバスの高さに対して 4 フレームまで入ります。
この時、キャンバスの幅は、 フレームの幅の 4 倍となり、キャンバスの高さは、フレームの高さの 4 倍となります。

キャンバスの最大サイズは幅 8000 px 、高さ 8000 px なので、この値を超える場合は読み込むことができません。

---

gif 形式で保存する場合は、 2 種類の保存方法を用意しています。

1 つ目は、選択しているドット絵レイヤーを、キャンバスサイズで保存する方法です。これはアニメーションはなしで、
1 フレームとして保存されます。

これは、メニューの「レイヤー」をクリックし、「ドット絵レイヤー」から
「__gif で保存(1フレーム)__」をクリックすることで、保存されます。

2 つ目は、選択しているドット絵レイヤーを、アニメーションとして保存する方法です。
これは、「ドット絵アニメーション」ウィンドウで、アニメーションを作成している場合のみ保存できます。

「ドット絵アニメーション」で選択しているアニメーションを gif として保存します。
gif の幅と高さは、選択しているアニメーションのフレームの幅と高さになります。

「アニメーションフレーム」ウィンドウの「時間(秒)」の値が、
gif アニメーションの再生秒数とだいたい同じになります。
アニメーションがスタートしてからアニメーションが終わるまでの秒数です。

これは、メニューの「レイヤー」をクリックし、「ドット絵レイヤー」から
「__gif で保存(アニメーション)__」をクリックすることで、保存されます。
